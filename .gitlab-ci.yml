stages:
  - build

default:
  image: mcr.microsoft.com/dotnet/core/sdk:3.1

.build-win-x64: &build-win-x64 
  - "dotnet publish -r win-x64 -c Release /p:PublishSingleFile=true"
  
master:
  stage: build
  script: 
    - *build-win-x64
  except:
    - tags
  artifacts:
    paths: 
      - LICENSE
      - README.md
      - CHANGELOG.md
      - sample-config.ini
      - Injector/bin/Release/netcoreapp3.0/win-x64/publish/Injector.exe

release:
  stage: build
  script: *build-win-x64
  only:
    - tags
    - /^v\d+\.\d+\.\d+$/
